language: python

python:
  - "2.7"

# command to install dependencies
install:
  - pip install -r test-requirements.txt .
  # Remove pyc
  - find . -name "*.pyc" -or -name "*$py.class" | xargs rm -f

# command to run tests
script:
  # py-without-modules
  # - python2.7 ./bin/trial --reporter=bwverbose --without-module OpenSSL --without-module Crypto twisted

  # py-select-gc
  # - python ./bin/trial --reporter=bwverbose --force-gc twisted

  # python-3.3-tests
  # - python3.3 admin/run-python3-tests

  # python-2.7
  - ./bin/trial --reporter=bwverbose --unclean-warnings --reactor=select twisted
  - find . -name "*.pyc" -or -name "*$py.class" | xargs rm -f
  - rm -rf _trial_temp
  - ./bin/trial --reporter=bwverbose --unclean-warnings --reactor=poll twisted
  - find . -name "*.pyc" -or -name "*$py.class" | xargs rm -f
  - rm -rf _trial_temp
  - ./bin/trial --reporter=bwverbose --unclean-warnings --reactor=epoll twisted
  - find . -name "*.pyc" -or -name "*$py.class" | xargs rm -f
  - rm -rf _trial_temp
  - ./bin/trial --reporter=bwverbose --unclean-warnings --reactor=glib2 twisted

  # pyflakes
  # - pyflakes twisted

  # documentation
  # api-documentation
  - .bin/admin/build-apidocs . apidocs
  # process-docs
  - .bin/admin/build-docs . doc/core/howto/template.tpl
